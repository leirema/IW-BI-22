{% extends "base.html" %}
{% load static %}
{% block styles %}
<link rel="stylesheet" href="{% static 'css/estilos_detalle.css' %}" />
<link rel="stylesheet" href="{% static 'css/estilos_tabla.css' %}" />
{% endblock %}
{% block content %}
<section class="comparativa_detail">
    <section class="cabecera_comparativa">
        {% if comparativa.imagen %}
        <img alt="{{ comparativa.titulo }}" src="{{comparativa.imagen.url}}" class="imagen_comparativa_detalle">
        {% endif %}
        <div class="info_comparativa">
            <h1>{{ comparativa.titulo }}</h1>
            <p class="meta">
                <span>{{ comparativa.fecha }}</span> ·
                <span>Obj: {{ comparativa.objetividad|floatformat:1 }}/5</span>
            </p>
            <p class="categorias">
                {% for cat in comparativa.categoria.all %}
                <a href="{% url 'categoria' cat.id %}" class="badge">{{ cat.nombre }}</a>
                {% endfor %}
            </p>
            <article class="contenido_comparativa">
                <p>{{ comparativa.contenido|linebreaks }}</p>
            </article>
        </div>
    </section>
    <section class="noticia_table">
        <h2>Noticias asociadas</h2>
        <table class="tabla_comparativa">
            <thead>
                <tr>
                    <th>Medio</th>
                    <th>Titular</th>
                    <th>Resumen</th>
                    <th>Sesgo</th>
                </tr>
            </thead>
            <tbody>
                {% for noticia in noticias_relacionadas %}
                <tr>
                    <td class="medio">
                        <a href="{% url 'medio' noticia.medio.id %}" class="medio_url">
                            {% if noticia.medio.logo %}
                            <img alt="{{ noticia.medio.nombre }}" src="{{noticia.medio.logo.url }}" class="logo_medio">
                            {% endif %}
                            <p>{{ noticia.medio.nombre }}</p>
                        </a>
                    </td>
                    <td class="titular">
                        <a href="{{ noticia.enlace }}" target="_blank">{{ noticia.titulo }}</a>
                    </td>
                    <td class="resumen">
                        {{ noticia.resumen|truncatewords:100 }}
                    </td>
                    <td class="sesgos">
                        <ul>
                            <li><strong>Ideológico:</strong> {{ noticia.get_sesgo_ideologico}} ({{ noticia.sesgo_ideologico|floatformat:1 }})</li>
                            <li><strong>Emocional:</strong> {{ noticia.get_sesgo_emocional }} ({{ noticia.sesgo_emocional|floatformat:1 }})</li>
                            <li><strong>Enfoque:</strong> {{ noticia.sesgo_enfoque.nombre }}</li>
                        </ul>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" class="sin-noticias">No hay noticias asociadas a esta comparativa.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </section>
</section>
{% endblock %}