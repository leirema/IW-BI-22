{% extends "base.html" %}
{% block content %}
<section class="medio_header">
    <div class="medio_info">
        {% if medio.logo %}
        <img alt="{{ medio.nombre }}" src="{{medio.logo.url}}" class="logo_medio_detalle">
        {% endif %}
        <div>
            <h1>{{ medio.nombre }}</h1>
            <p class="tipo_pais">{{ medio.get_tipo_display }} · {{ medio.pais }}</p>
            <p>{{ medio.descripcion }}</p>
            <a href="{{ medio.web }}" target="_blank" class="enlace_medio">Visitar sitio web</a>
        </div>
    </div>
    <div class="medio_graf">
        <div>
            <canvas id="perfil_sesgos"></canvas>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            const data_sesgo = {{data_sesgo|safe}};
            const ctx = document.getElementById('perfil_sesgos');
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Ideología', 'Emocional', 'Enfoque dominante'],
                    datasets: [{
                        label: 'Perfil del medio',
                        data: [data_sesgo.ideologia, data_sesgo.emocion, data_sesgo.enfoque ],
                        borderWidth: 2,
                        borderColor: 'rgba(255, 99, 132, 0.8)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        pointBackgroundColor: 'rgba(255, 99, 132, 1)'
                    }]
                },
                options: {
                    scales: {
                        r: {
                            beginAtZero: true,
                            min: 0,
                            max: 5
                        }
                    }
                }
            });
        </script>
        <p class="explicacion_sesgo">{{ label_ideologia }}</p>
    </div>
</section>
<section class="comparativa_medio">
    <h2>Comparativas en este Medio</h2>
    <div class="carrusel">
        {% for comp in comparativas_atravesadas %}
        <article class="card_horizontal">
            {% if comp.imagen %}
            <img alt="{{ comp.titulo }}" src="{{comp.imagen.url}}">
            {% endif %}
            <div>
                <h3><a href="{% url 'comparativa' comp.id %}">{{ comp.titulo }}</a></h3>
                <p class="meta">
                    <span>{{ comp.fecha }}</span> ·
                    <span>Objetividad: {{ comp.objetividad|floatformat:1 }}/5</span>
                </p>
                <p>Palabras clave:{{ comp.claves }}</p>
            </div>
        </article>
        {% endfor %}
    </div>
</section>
<section class="noticia_list">
    <h2>Noticias de este médio</h2>
    <div class="grid_noticias">
        {% for not in noticias_relacionadas %}
        <article class="card_noticia">
            {% if not.imagen %}
            <img alt="{{ not.titulo }}" src="{{not.imagen.url}}">
            {% endif %}
            <div>
                <h3><a href="{% url 'noticia' not.id %}">{{ not.titulo }}</a></h3>
                <p>{{ not.resumen|truncatewords:15 }}</p>
            </div>
        </article>
        {% empty %}
        <p>No hay noticias publicadas.</p>
        {% endfor %}
    </div>
</section>
{% endblock %}